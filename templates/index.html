<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™êµ ìŠ¤ë§ˆíŠ¸ ì•„ì¹´ì´ë¸Œ</title>
    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- ì•„ì´ì½˜ (Bootstrap Icons) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        /* ë„¤ë¹„ê²Œì´ì…˜ íƒ­ ìŠ¤íƒ€ì¼ */
        .nav-pills .nav-link {
            color: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            padding: 8px 20px;
        }

        .nav-pills .nav-link.active {
            background-color: white;
            color: #0d6efd;
            /* Bootstrap Primary Color */
            font-weight: bold;
        }

        .nav-pills .nav-link:hover {
            color: white;
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* ì¹´ë“œ ì´ë¯¸ì§€ ë†’ì´ ê³ ì • + ì „ì²´ ì´ë¯¸ì§€ ë³´ì´ë„ë¡ */
        .card-img-top {
            height: 250px;
            object-fit: contain;
            /* ì´ë¯¸ì§€ê°€ ì˜ë¦¬ì§€ ì•Šê³  ì „ì²´ê°€ ë³´ì„ */
            background-color: #f8f9fa;
            /* ì—¬ë°± ë°°ê²½ìƒ‰ */
            cursor: pointer;
            /* í´ë¦­ ê°€ëŠ¥í•¨ì„ í‘œì‹œ */
        }

        /* ì´ë¯¸ì§€ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            animation: fadeIn 0.3s;
        }

        .image-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
        }

        .image-modal-content img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10000;
        }

        .image-modal-close:hover {
            color: #ff0000;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* ë§í¬ ì¹´ë“œ ìŠ¤íƒ€ì¼ (4:3 ë¹„ìœ¨) */
        .link-card-img-wrapper {
            position: relative;
            width: 100%;
            padding-top: 75%;
            /* 4:3 ë¹„ìœ¨ */
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .link-card-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
        }

        /* í˜¸ë²„ íš¨ê³¼ */
        .hover-shadow:hover {
            transform: translateY(-5px);
            box-shadow: 0 .5rem 1rem rgba(0, 0, 0, .15) !important;
            transition: all 0.3s;
        }

        /* ë“œë˜ê·¸ ë°©ì§€ (ì´ë¯¸ì§€ ë³´í˜¸) */
        img {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }

        /* ì ê¸ˆ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .lock-screen {
            background-color: #f8f9fa;
            border-radius: 15px;
            padding: 3rem;
            text-align: center;
            border: 2px dashed #dee2e6;
        }
    </style>
</head>
<!-- ìš°í´ë¦­ ë°©ì§€, ë“œë˜ê·¸ ë°©ì§€, ì„ íƒ ë°©ì§€ ì ìš© -->

<body class="bg-light" oncontextmenu="return false" onselectstart="return false" ondragstart="return false">

    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (íŒŒë€ìƒ‰ ë°°ê²½ + íƒ­ ë©”ë‰´) -->
    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (íŒŒë€ìƒ‰ ë°°ê²½ + ëª¨ë°”ì¼ ìµœì í™”) -->
    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (íŒŒë€ìƒ‰ ë°°ê²½ + ëª¨ë°”ì¼ ìµœì í™”) -->
    <nav class="navbar navbar-expand navbar-dark bg-primary shadow-sm py-2 sticky-top">
        <div class="container-fluid px-2 px-md-3">
            <!-- 1. ì™¼ìª½: í–„ë²„ê±° ë²„íŠ¼ + í•™êµ ì•„ì´ì½˜ -->
            <div class="d-flex align-items-center me-auto">
                <button class="navbar-toggler me-1 border-0 p-0 d-inline-block" type="button">
                    <span class="navbar-toggler-icon" style="width: 1.2em; height: 1.2em;"></span>
                </button>
                <a class="navbar-brand fs-4 me-0" href="/">
                    ğŸ« <span class="d-none d-md-inline fw-bold ms-1" style="font-size: 1.2rem;">School Archive</span>
                </a>
            </div>

            <!-- 2. ì¤‘ì•™: ë©”ë‰´ ì•„ì´ì½˜ë“¤ (í•œ ì¤„ë¡œ ë°°ì¹˜) -->
            <ul class="nav nav-pills flex-row mx-2" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active px-2 px-md-3 fs-5" id="tab-media" data-bs-toggle="pill"
                        data-bs-target="#content-media" type="button" data-bs-toggle="tooltip"
                        data-bs-placement="bottom" title="ê°¤ëŸ¬ë¦¬">
                        <span>ğŸ“¸</span> <span class="d-none d-md-inline fs-6 ms-1">ê°¤ëŸ¬ë¦¬</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link px-2 px-md-3 fs-5" id="tab-text" data-bs-toggle="pill"
                        data-bs-target="#content-text" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom"
                        title="ê²Œì‹œíŒ">
                        <span>ğŸ“</span> <span class="d-none d-md-inline fs-6 ms-1">ê²Œì‹œíŒ</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link px-2 px-md-3 fs-5" id="tab-code" data-bs-toggle="pill"
                        data-bs-target="#content-code" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom"
                        title="ê°œë°œ/ìë£Œ">
                        <span>ğŸ’»</span> <span class="d-none d-md-inline fs-6 ms-1">ê°œë°œ/ìë£Œ</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link px-2 px-md-3 fs-5" id="tab-link" data-bs-toggle="pill"
                        data-bs-target="#content-link" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom"
                        title="ê³µì‹ ë§í¬">
                        <span>ğŸ”—</span> <span class="d-none d-md-inline fs-6 ms-1">ê³µì‹ ë§í¬</span>
                    </button>
                </li>
            </ul>

            <!-- 3. ì˜¤ë¥¸ìª½: ìœ ì € í”„ë¡œí•„ (í•­ìƒ ë³´ì„) -->
            <div class="d-flex align-items-center ms-auto">
                {% if user.is_authenticated %}
                <div class="dropdown">
                    <button
                        class="btn btn-outline-light dropdown-toggle rounded-pill btn-sm d-flex align-items-center border-0 px-2"
                        type="button" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle fs-5"></i>
                        <span class="d-none d-sm-inline ms-1">{{ user.username }}</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow">
                        {% if user.is_superuser %}
                        <li><a class="dropdown-item small" href="/admin/">âš™ï¸ ê´€ë¦¬ì</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        {% endif %}
                        <li><a class="dropdown-item text-danger small" href="/accounts/logout/">ë¡œê·¸ì•„ì›ƒ</a></li>
                    </ul>
                </div>
                {% else %}
                <a href="/accounts/google/login/?process=login"
                    class="btn btn-light rounded-pill text-primary fw-bold btn-sm px-2">
                    <i class="bi bi-person-fill"></i>
                </a>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- [NEW] í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ (ê¸€ì“°ê¸°) -->
    {% if user.is_authenticated %}
    <div class="position-fixed bottom-0 end-0 p-4" style="z-index: 1000;">
        <button id="fab-btn"
            class="btn btn-primary rounded-circle shadow-lg d-flex align-items-center justify-content-center"
            style="width: 60px; height: 60px; font-size: 24px;" data-bs-toggle="modal" data-bs-target="#mediaModal">
            <i class="bi bi-plus-lg"></i>
        </button>
    </div>
    {% endif %}

    <!-- [NEW] ì‘ì„± ëª¨ë‹¬ë“¤ -->

    <!-- 1. ì‚¬ì§„ ì˜¬ë¦¬ê¸° ëª¨ë‹¬ -->
    <div class="modal fade" id="mediaModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">ğŸ“¸ ì‚¬ì§„ ì˜¬ë¦¬ê¸°</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="{% url 'media_create' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">ì œëª©</label>
                            <input type="text" name="title" class="form-control" placeholder="ì‚¬ì§„ ì œëª©" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">í•™ê¸‰ ì‚¬ì§„ íŒŒì¼</label>
                            <input type="file" name="file" class="form-control" accept="image/*,video/*" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ì„¤ëª…</label>
                            <textarea name="description" class="form-control" rows="3"
                                placeholder="ì–´ë–¤ ìƒí™©ì¸ê°€ìš”?"></textarea>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="applyWebtoonFilter"
                                name="apply_webtoon_filter">
                            <label class="form-check-label text-primary fw-bold" for="applyWebtoonFilter">
                                âœ¨ AI ì›¹íˆ°ì²´ë¡œ ë³€í™˜í•˜ê¸°
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-primary">ì—…ë¡œë“œ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 2. ê¸€ ì“°ê¸° ëª¨ë‹¬ -->
    <div class="modal fade" id="textModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">ğŸ“ ê²Œì‹œê¸€ ì‘ì„±</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="{% url 'text_create' %}" method="post">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">ì œëª©</label>
                            <input type="text" name="title" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ì‘ì„±ì</label>
                            <input type="text" name="author_name" class="form-control" placeholder="ì´ë¦„" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ë‚´ìš©</label>
                            <textarea name="content" class="form-control" rows="5" required></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-primary">ë“±ë¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 3. ìë£Œ ê³µìœ  ëª¨ë‹¬ -->
    <div class="modal fade" id="codeModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">ğŸ’» ìë£Œ ê³µìœ </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="{% url 'code_create' %}" method="post">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">ì œëª©</label>
                            <input type="text" name="title" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                            <select name="category" class="form-select">
                                <option value="GAME">ì›¹ ê²Œì„</option>
                                <option value="COLAB">êµ¬ê¸€ Colab</option>
                                <option value="GITHUB">GitHub</option>
                                <option value="OTHER" selected>ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">URL (ë§í¬)</label>
                            <input type="url" name="url" class="form-control" placeholder="https://..." required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ì„¤ëª…</label>
                            <textarea name="description" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-primary">ê³µìœ </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ë©”ì‹œì§€ ì•Œë¦¼ (ìŠ¹ì¸ ëŒ€ê¸° ë“±) -->
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- ë©”ì¸ íƒ€ì´í‹€ ë° ê²€ìƒ‰ì°½ -->
    <!-- ë©”ì¸ íƒ€ì´í‹€ ë° ê²€ìƒ‰ì°½ -->
    <div class="container py-3 text-center">
        <!-- ğŸ” ê²€ìƒ‰ì°½ (ì´ì „ íƒ€ì´í‹€ ì‚­ì œë¨) -->
        {% if user.is_authenticated %}
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <form action="/" method="GET" class="d-flex shadow-sm rounded-pill bg-white p-1 border">
                    <input type="text" name="q" class="form-control border-0 rounded-pill ps-4" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥..."
                        value="{{ search_term }}" style="box-shadow: none;">
                    <button type="submit" class="btn btn-primary rounded-pill px-4">
                        <i class="bi bi-search"></i>
                    </button>
                </form>
                {% if search_term %}
                <div class="mt-2 text-start ms-2">
                    <span class="badge bg-secondary">"{{ search_term }}" ê²€ìƒ‰ë¨</span>
                    <a href="/" class="text-decoration-none ms-2 small text-muted">ğŸ”„ ì´ˆê¸°í™”</a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- ì½˜í…ì¸  ì˜ì—­ (íƒ­ ë‚´ìš©) -->
    <div class="container pb-5">
        <div class="tab-content" id="pills-tabContent">

            <!-- 1. ë¯¸ë””ì–´ ê°¤ëŸ¬ë¦¬ (ì´ë¯¸ì§€/ì˜ìƒ) - ë¡œê·¸ì¸ í•„ìˆ˜ ğŸ”’ -->
            <div class="tab-pane fade show active" id="content-media" role="tabpanel">
                {% if user.is_authenticated %}
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for post in media_posts %}
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 hover-shadow">
                            {% if post.file %}
                            <img src="{{ post.file.url }}" class="card-img-top" alt="{{ post.title }}"
                                onclick="openImageModal(this.src, '{{ post.title }}')" oncontextmenu="return false"
                                onerror="this.onerror=null; this.src='https://via.placeholder.com/400x300?text=No+Image';">
                            {% else %}
                            <div
                                class="card-img-top d-flex align-items-center justify-content-center bg-secondary text-white">
                                <span>ì´ë¯¸ì§€ ì—†ìŒ</span>
                            </div>
                            {% endif %}

                            <div class="card-body">
                                <h5 class="card-title fw-bold">{{ post.title }}</h5>
                                <p class="card-text text-muted small">{{ post.description|truncatechars:50 }}</p>

                                {% if post.ai_caption %}
                                <div
                                    class="alert alert-info py-2 px-3 mt-3 mb-0 small border-0 bg-opacity-10 bg-info text-dark">
                                    <i class="bi bi-robot me-1 text-primary"></i>
                                    {{ post.ai_caption }}
                                </div>
                                {% endif %}
                            </div>
                            <div
                                class="card-footer bg-white border-top-0 d-flex justify-content-between align-items-center">
                                <small class="text-muted">{{ post.created_at|date:"Y-m-d" }}</small>
                                <div>
                                    <i class="bi bi-heart-fill text-danger"></i> {{ post.like_count }}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center py-5 text-muted">
                        <div class="fs-1 mb-3">ğŸ–¼ï¸</div>
                        <p>
                            {% if search_term %} '{{ search_term }}' ê²°ê³¼ ì—†ìŒ {% else %} ë“±ë¡ëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤. {% endif %}
                        </p>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <!-- ğŸ”’ ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ì•ˆë‚´ í™”ë©´ -->
                <div class="lock-screen">
                    <div class="display-1 mb-3">ğŸ”’</div>
                    <h3 class="fw-bold">í•™êµ êµ¬ì„±ì› ì „ìš© ê³µê°„ì…ë‹ˆë‹¤</h3>
                    <p class="text-muted mb-4">ì‚¬ì§„ì„ ë³´ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <a href="/accounts/google/login/?process=login"
                        class="btn btn-primary btn-lg rounded-pill px-5 shadow-sm">
                        <i class="bi bi-google me-2"></i> êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
                    </a>
                </div>
                {% endif %}
            </div>

            <!-- 2. ê²Œì‹œíŒ (ê¸€) - ë¡œê·¸ì¸ í•„ìˆ˜ ğŸ”’ -->
            <div class="tab-pane fade" id="content-text" role="tabpanel">
                {% if user.is_authenticated %}
                <div class="row row-cols-1 row-cols-md-2 g-4">
                    {% for post in text_posts %}
                    <div class="col">
                        <div class="card h-100 border-2 hover-shadow">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-2 text-secondary small">
                                    <span>{{ post.created_at|date:"Y.m.d" }}</span>
                                    <span>{{ post.author_name }}</span>
                                </div>
                                <h4 class="card-title fw-bold">{{ post.title }}</h4>
                                <p class="card-text mt-3">{{ post.content|truncatechars:100 }}</p>
                            </div>
                            <div class="card-footer bg-white border-0 text-end">
                                <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal"
                                    data-bs-target="#textModal{{ post.id }}">ë” ë³´ê¸°</button>
                            </div>
                        </div>

                        <!-- ëª¨ë‹¬ (ìƒëµ ì—†ì´ ë‚´ìš© í‘œì‹œ) -->
                        <div class="modal fade" id="textModal{{ post.id }}" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title fw-bold">{{ post.title }}</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body py-4" style="white-space: pre-line;">{{ post.content }}</div>
                                    <div class="modal-footer">
                                        <small class="text-muted me-auto">ì‘ì„±ì: {{ post.author_name }}</small>
                                        <button type="button" class="btn btn-secondary"
                                            data-bs-dismiss="modal">ë‹«ê¸°</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center py-5 text-muted">
                        <p>ë“±ë¡ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <!-- ğŸ”’ ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ì•ˆë‚´ -->
                <div class="lock-screen">
                    <div class="fs-1 mb-3">ğŸ“</div>
                    <h4 class="fw-bold">ê²Œì‹œíŒì€ ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤</h4>
                    <p class="text-muted">í•™êµ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
                </div>
                {% endif %}
            </div>

            <!-- 3. ê°œë°œ/ìë£Œ (ì½”ë“œ) - ë¡œê·¸ì¸ í•„ìˆ˜ ğŸ”’ -->
            <div class="tab-pane fade" id="content-code" role="tabpanel">
                {% if user.is_authenticated %}
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for link in code_links %}
                    <div class="col">
                        <div class="card h-100 border-dark hover-shadow">
                            <div class="card-header bg-dark text-white d-flex justify-content-between">
                                <span class="badge bg-secondary">{{ link.get_category_display }}</span>
                                <small>{{ link.created_at|date:"m.d" }}</small>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title fw-bold">
                                    <i class="bi bi-code-slash me-2"></i>{{ link.title }}
                                </h5>
                                <!-- ì¤„ë°”ê¿ˆ í•„í„° ì ìš©ë¨ -->
                                <p class="card-text text-muted small">{{ link.description|linebreaksbr }}</p>
                            </div>
                            <div class="card-footer bg-white border-0">
                                <a href="{{ link.url }}" target="_blank" class="btn btn-dark w-100">
                                    ë°”ë¡œê°€ê¸° <i class="bi bi-box-arrow-up-right ms-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center py-5 text-muted">
                        <p>ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <!-- ğŸ”’ ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ì•ˆë‚´ -->
                <div class="lock-screen">
                    <div class="fs-1 mb-3">ğŸ’»</div>
                    <h4 class="fw-bold">ìˆ˜ì—… ìë£ŒëŠ” ë¡œê·¸ì¸ í›„ í™•ì¸í•˜ì„¸ìš”</h4>
                    <p class="text-muted">ì™¸ë¶€ì¸ì˜ ì ‘ê·¼ì´ ì œí•œë©ë‹ˆë‹¤.</p>
                </div>
                {% endif %}
            </div>

            <!-- 4. ê³µì‹ ë§í¬ - ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆìŒ (ê³µê°œ) ğŸŒ -->
            <div class="tab-pane fade" id="content-link" role="tabpanel">
                <div class="row row-cols-2 row-cols-md-4 g-4">
                    {% for link in official_links %}
                    <div class="col">
                        <a href="{{ link.url }}" target="_blank" class="text-decoration-none text-dark">
                            <div class="card h-100 shadow-sm border-0 hover-shadow text-center">
                                <div class="link-card-img-wrapper rounded-top">
                                    <div class="link-card-icon">
                                        {% if link.icon_type == 'YOUTUBE' %}<i class="bi bi-youtube text-danger"></i>
                                        {% elif link.icon_type == 'INSTAGRAM' %}<i
                                            class="bi bi-instagram text-danger"></i>
                                        {% elif link.icon_type == 'BLOG' %}<i
                                            class="bi bi-pencil-square text-success"></i>
                                        {% else %}<i class="bi bi-globe text-primary"></i>{% endif %}
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h6 class="card-title fw-bold mb-0">{{ link.title }}</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center py-5 text-muted">
                        <div class="fs-1 mb-3">ğŸ”—</div>
                        <p>ë“±ë¡ëœ ë§í¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>

        </div>
    </div>

    <!-- í•˜ë‹¨ í‘¸í„° -->
    <footer class="py-4 mt-auto bg-white border-top">
        <div class="container text-center text-muted">
            &copy; 2024 School Archive Project. All rights reserved.
        </div>
    </footer>

    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ë³´ì•ˆ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
            // alert ì œê±°: ë„ˆë¬´ ìì£¼ ëœ¨ë©´ ë¶ˆí¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¡°ìš©íˆ ì°¨ë‹¨
        });

        document.onkeydown = function (e) {
            if (e.keyCode == 123) return false;
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) return false;
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) return false;
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) return false;
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) return false;
        }

        // [NEW] íƒ­ì— ë”°ë¼ FAB ë²„íŠ¼ ë™ì‘ ë³€ê²½ ë° íƒ­ ìƒíƒœ ìœ ì§€
        document.addEventListener("DOMContentLoaded", function () {
            const fabBtn = document.getElementById('fab-btn');
            if (!fabBtn) return;

            const tabs = {
                'media': { target: '#mediaModal', btnClass: 'btn-primary', icon: 'bi-camera-fill' }, // 'bi-plus-lg' -> 'bi-camera-fill'
                'text': { target: '#textModal', btnClass: 'btn-success', icon: 'bi-pencil-fill' },
                'code': { target: '#codeModal', btnClass: 'btn-dark', icon: 'bi-code-slash' },
                'link': { target: null, btnClass: 'btn-secondary', icon: 'bi-slash-circle' } // ë§í¬ íƒ­ì—ì„  ë²„íŠ¼ ë¹„í™œì„±í™” ë˜ëŠ” ìˆ¨ê¹€
            };

            // 1. URL íŒŒë¼ë¯¸í„°(?tab=...) í™•ì¸í•˜ì—¬ íƒ­ í™œì„±í™”
            const urlParams = new URLSearchParams(window.location.search);
            const activeTab = urlParams.get('tab') || 'media';

            const triggerEl = document.querySelector(`#tab-${activeTab}`);
            if (triggerEl) {
                const tabInstance = new bootstrap.Tab(triggerEl);
                tabInstance.show();
                updateFab(activeTab);
            }

            // 2. íƒ­ í´ë¦­ ì‹œ FAB ìƒíƒœ ë³€ê²½
            const tabLinks = document.querySelectorAll('button[data-bs-toggle="pill"]');
            tabLinks.forEach(el => {
                el.addEventListener('shown.bs.tab', function (event) {
                    const targetId = event.target.id.replace('tab-', ''); // media, text, code
                    updateFab(targetId);
                });
            });

            function updateFab(type) {
                const config = tabs[type];
                if (!config) return;

                // í´ë˜ìŠ¤ ì´ˆê¸°í™”
                fabBtn.className = 'btn rounded-circle shadow-lg d-flex align-items-center justify-content-center';
                fabBtn.classList.add(config.btnClass || 'btn-primary');

                // ì•„ì´ì½˜ ë³€ê²½
                fabBtn.innerHTML = `<i class="bi ${config.icon || 'bi-plus-lg'}"></i>`;

                // íƒ€ê²Ÿ ë³€ê²½
                if (config.target) {
                    fabBtn.style.display = 'flex';
                    fabBtn.setAttribute('data-bs-toggle', 'modal');
                    fabBtn.setAttribute('data-bs-target', config.target);
                } else {
                    fabBtn.style.display = 'none'; // ë§í¬ íƒ­ ë“±ì—ì„œëŠ” ìˆ¨ê¹€
                    fabBtn.removeAttribute('data-bs-toggle'); // [Fix] ì”ì—¬ ì†ì„± ì œê±°
                    fabBtn.removeAttribute('data-bs-target'); // [Fix] ì”ì—¬ ì†ì„± ì œê±°
                }
            }

            // [NEW] íˆ´íŒ ì´ˆê¸°í™” (ì•„ì´ì½˜ ë©”ë‰´ìš©)
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl)
            })
        });

        // ì´ë¯¸ì§€ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° í•¨ìˆ˜
        function openImageModal(imageSrc, title) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');

            modal.style.display = 'block';
            modalImg.src = imageSrc;
            modalTitle.textContent = title || '';

            // ESC í‚¤ë¡œ ë‹«ê¸°
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    closeImageModal();
                }
            });
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
        }

        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('click', function (e) {
            const modal = document.getElementById('imageModal');
            if (e.target === modal) {
                closeImageModal();
            }
        });
    </script>

    <!-- ì´ë¯¸ì§€ ëª¨ë‹¬ -->
    <div id="imageModal" class="image-modal">
        <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
        <div class="image-modal-content">
            <img id="modalImage" src="" alt="">
            <div class="text-center mt-3">
                <h5 id="modalTitle" class="text-white"></h5>
            </div>
        </div>
    </div>

</body>

</html>