###################################################

🏫 학교 AI 아카이브 프로젝트 개발 완료 보고서 (v1.1)

최종 업데이트: 2026년 1월 6일
상태: 인증 시스템 구축 및 고도화 기획 단계

###################################################

프로젝트 개요

목표: 학교 활동 사진을 기록하고, AI가 자동으로 설명을 생성해주는 스마트 아카이브 플랫폼 구축.
서버 환경: Oracle Cloud Infrastructure (OCI) ARM 인스턴스 (Ubuntu).
기술 스택: Django 6.0, Gunicorn, Nginx, SQLite.
핵심 기능:

OCI Object Storage 연동 (Native SDK 사용)

Gemini AI 사진 자동 분석 및 캡션 생성

하이브리드 검색 (제목 + 사용자 설명 + AI 설명)

구글 소셜 로그인 (OAuth2) 및 관리자 승인제 도입

해결된 주요 이슈 (Troubleshooting)

[완료] OCI MissingContentLength (411 Error):

해결: boto3 제거 후 oci 공식 SDK로 커스텀 스토리지 구현.

[완료] 검색 기능 고도화:

해결: Django Q 객체를 활용하여 '제목', '사용자 설명', 'AI 설명' 3가지 필드 동시 검색 구현.

[진행중] 회원 권한 관리:

상태: django-allauth 설치 및 구글 로그인 설정 완료.

과제: 비인가 사용자의 갤러리 접근 차단 UI 적용 필요.

핵심 파일 구조

/var/www/school_project/
├── .env                          # API 키 및 비밀번호 관리
├── config/

│   ├── settings.py               # allauth 및 OCI 설정 포함
│   ├── urls.py                   # 로그인 경로 포함
│   └── storage.py                # OCI Native SDK 스토리지
│
└── photo/

├── adapter.py                # [신규] 회원가입 시 자동 비활성화(승인 대기) 로직
├── models.py

├── signals.py                # AI 분석 및 파일 삭제
└── views.py                  # 검색 로직 포함

향후 과제 (단기)

✅ 구글 로그인 연동 (API 키 발급 완료)
✅ 갤러리 접근 권한 제어 (비로그인 사용자 차단)
⬜ HTTPS 보안 연결 (SSL 인증서 발급)
⬜ 학교 로고 및 테마 색상 적용

===================================================
5. 중장기 고도화 계획 (Roadmap)

🚀 1. 관리자 전용 '대량 업로드(Bulk Upload)' 기능

목적: 교사가 수십 장의 행사 사진을 한 번에 올릴 때 편의성 제공.

기능 정의:

드래그 앤 드롭으로 파일 다중 선택.

엑셀 시트 형태의 UI: 각 사진별 미리보기(Thumbnail) 제공.

제목/설명 일괄 입력 기능 (예: 모든 사진 제목을 "체육대회"로 통일).

글/코드의 경우 파일 앞부분 텍스트 미리보기 제공.

📱 2. 모바일 전용 업로드 UI (Student Experience)

목적: 학생회나 학생들이 스마트폰으로 현장 사진을 바로 업로드.

기능 정의:

모바일 화면에 최적화된 터치 친화적 업로드 버튼.

카메라/갤러리 앱 직접 연동.

이미지 리사이징(압축) 후 전송하여 데이터 절약.

☁️ 3. 서버 및 스토리지 이전 (Migration)

배경: 현재 OCI 프리티어의 속도 저하 및 스토리지 용량/비용 우려.

목표: 동시 접속자 처리가 원활하고 가성비가 좋은 인프라로 이동.

후보지:

스토리지: Cloudflare R2 (트래픽 비용 무료) 또는 AWS S3.

컴퓨팅: AWS Lightsail 또는 Naver Cloud (국내 속도 이점).

CDN: 이미지 로딩 속도 가속을 위한 CDN 도입 필수.

===================================================
6. 운영 매뉴얼 (지우지 마세요.)

가상환경 활성화

source venv/bin/activate

패키지 설치 (allauth 추가됨)

pip install django-allauth

DB 마이그레이션 (인증 테이블 생성)

python manage.py migrate



===================================================
5. 운영 및 유지보수 매뉴얼
===================================================

# 1. 가상환경 활성화
source venv/bin/activate
가상환경 비활성화
deactivate

# 2. 기존 DB 및 설계도 삭제 (완전 초기화)
rm db.sqlite3
rm -rf photo/migrations
mkdir -p photo/migrations
touch photo/migrations/__init__.py

# 3. DB 새로 만들기
python manage.py makemigrations
python manage.py migrate

# 4. 관리자 계정 생성 (DB가 지워졌을 때 다시 만드는 방법)
python manage.py createsuperuser
# (아이디, 비밀번호 입력 후 y)

# 5. 서버 재시작
sudo systemctl restart gunicorn
sudo systemctl restart nginx

로그 확인: sudo journalctl -u gunicorn -f 명령어로 실시간 디버깅 가능.
모델 변경: 향후 gemini-3 모델이 만료되거나 더 좋은 모델이 나오면 photo/signals.py에서 모델명 수정 필요.

저장소 초기화 및 첫 커밋(Git에게 "이 폴더를 관리해줘!"라고 명령하는 법)

# 프로젝트 폴더인지 확인
cd /var/www/school_project

# Git 초기화 (이제 .git 폴더가 생깁니다)
git init

# .gitignore가 잘 작동하는지 확인하고 모든 파일 담기
git add .

# 커밋 (저장)
git commit -m "첫 번째 커밋: 학교 홍보 플랫폼 기본 구축 완료"

패키지 설치 (allauth 추가됨)
pip install django-allauth

DB 마이그레이션 (인증 테이블 생성)
python manage.py migrate
